"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const h=require("react"),oe=require("phoenix");var F={exports:{}},g={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q;function se(){if(q)return g;q=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(t,r,c){var m=null;if(c!==void 0&&(m=""+c),r.key!==void 0&&(m=""+r.key),"key"in r){c={};for(var i in r)i!=="key"&&(c[i]=r[i])}else c=r;return r=c.ref,{$$typeof:o,type:t,key:m,ref:r!==void 0?r:null,props:c}}return g.Fragment=a,g.jsx=s,g.jsxs=s,g}var j={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V;function ae(){return V||(V=1,process.env.NODE_ENV!=="production"&&function(){function o(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===re?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case E:return"Fragment";case C:return"Profiler";case x:return"StrictMode";case U:return"Suspense";case K:return"SuspenseList";case ee:return"Activity"}if(typeof e=="object")switch(typeof e.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),e.$$typeof){case d:return"Portal";case Z:return(e.displayName||"Context")+".Provider";case H:return(e._context.displayName||"Context")+".Consumer";case Q:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case z:return n=e.displayName||null,n!==null?n:o(e.type)||"Memo";case I:n=e._payload,e=e._init;try{return o(e(n))}catch{}}return null}function a(e){return""+e}function s(e){try{a(e);var n=!1}catch{n=!0}if(n){n=console;var l=n.error,R=typeof Symbol=="function"&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object";return l.call(n,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",R),a(e)}}function t(e){if(e===E)return"<>";if(typeof e=="object"&&e!==null&&e.$$typeof===I)return"<...>";try{var n=o(e);return n?"<"+n+">":"<...>"}catch{return"<...>"}}function r(){var e=O.A;return e===null?null:e.getOwner()}function c(){return Error("react-stack-top-frame")}function m(e){if(D.call(e,"key")){var n=Object.getOwnPropertyDescriptor(e,"key").get;if(n&&n.isReactWarning)return!1}return e.key!==void 0}function i(e,n){function l(){M||(M=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",n))}l.isReactWarning=!0,Object.defineProperty(e,"key",{get:l,configurable:!0})}function P(){var e=o(this.type);return L[e]||(L[e]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),e=this.props.ref,e!==void 0?e:null}function v(e,n,l,R,w,_,p,N){return l=_.ref,e={$$typeof:T,type:e,key:n,props:_,_owner:w},(l!==void 0?l:null)!==null?Object.defineProperty(e,"ref",{enumerable:!1,get:P}):Object.defineProperty(e,"ref",{enumerable:!1,value:null}),e._store={},Object.defineProperty(e._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(e,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(e,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:p}),Object.defineProperty(e,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:N}),Object.freeze&&(Object.freeze(e.props),Object.freeze(e)),e}function k(e,n,l,R,w,_,p,N){var b=n.children;if(b!==void 0)if(R)if(ne(b)){for(R=0;R<b.length;R++)u(b[R]);Object.freeze&&Object.freeze(b)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else u(b);if(D.call(n,"key")){b=o(e);var A=Object.keys(n).filter(function(te){return te!=="key"});R=0<A.length?"{key: someKey, "+A.join(": ..., ")+": ...}":"{key: someKey}",J[b+R]||(A=0<A.length?"{"+A.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,R,b,A,b),J[b+R]=!0)}if(b=null,l!==void 0&&(s(l),b=""+l),m(n)&&(s(n.key),b=""+n.key),"key"in n){l={};for(var Y in n)Y!=="key"&&(l[Y]=n[Y])}else l=n;return b&&i(l,typeof e=="function"?e.displayName||e.name||"Unknown":e),v(e,b,_,w,r(),l,p,N)}function u(e){typeof e=="object"&&e!==null&&e.$$typeof===T&&e._store&&(e._store.validated=1)}var f=h,T=Symbol.for("react.transitional.element"),d=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),H=Symbol.for("react.consumer"),Z=Symbol.for("react.context"),Q=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),ee=Symbol.for("react.activity"),re=Symbol.for("react.client.reference"),O=f.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=Object.prototype.hasOwnProperty,ne=Array.isArray,y=console.createTask?console.createTask:function(){return null};f={"react-stack-bottom-frame":function(e){return e()}};var M,L={},W=f["react-stack-bottom-frame"].bind(f,c)(),G=y(t(c)),J={};j.Fragment=E,j.jsx=function(e,n,l,R,w){var _=1e4>O.recentlyCreatedOwnerStacks++;return k(e,n,l,!1,R,w,_?Error("react-stack-top-frame"):W,_?y(t(e)):G)},j.jsxs=function(e,n,l,R,w){var _=1e4>O.recentlyCreatedOwnerStacks++;return k(e,n,l,!0,R,w,_?Error("react-stack-top-frame"):W,_?y(t(e)):G)}}()),j}process.env.NODE_ENV==="production"?F.exports=se():F.exports=ae();var S=F.exports;const X=h.createContext(void 0),ce=({children:o,socketUrl:a="ws://localhost:4000/socket",autoConnect:s=!1,token:t})=>{const[r,c]=h.useState(null),[m,i]=h.useState(!1),P=(f,T)=>{if(r!=null&&r.isConnected()){console.warn("Socket already connected");return}const d=new oe.Socket(T||a,{params:{token:f}});d.onOpen(()=>{console.log("Phoenix socket connected"),i(!0)}),d.onClose(()=>{console.log("Phoenix socket disconnected"),i(!1)}),d.onError(()=>{console.error("Phoenix socket error"),i(!1)}),d.connect(),c(d)},v=()=>{r&&(r.disconnect(),c(null),i(!1))},k=(f,T={})=>!r||!m?(console.warn("Socket not connected"),null):r.channel(f,T);h.useEffect(()=>(s&&t&&P(t),()=>{r!=null&&r.isConnected()&&r.disconnect()}),[]);const u={socket:r,connected:m,connect:P,disconnect:v,channel:k};return S.jsx(X.Provider,{value:u,children:o})},B=()=>{const o=h.useContext(X);if(!o)throw new Error("usePhoenix must be used within a PhoenixProvider");return o},le=({children:o,isAuthenticated:a,fallback:s=null,redirectTo:t,onUnauthorized:r})=>(h.useEffect(()=>{a||(t&&typeof window<"u"&&(window.location.href=t),r==null||r())},[a,t,r]),a?S.jsx(S.Fragment,{children:o}):S.jsx(S.Fragment,{children:s})),ue=({children:o,permissions:a,userPermissions:s,requireAll:t=!1,fallback:r=null,onUnauthorized:c})=>{const m=t?a.every(i=>s.includes(i)):a.some(i=>s.includes(i));return h.useEffect(()=>{m||c==null||c()},[m,c]),m?S.jsx(S.Fragment,{children:o}):S.jsx(S.Fragment,{children:r})},ie=(o,a={},s={})=>{const{channel:t,connected:r}=B(),[c,m]=h.useState(null),[i,P]=h.useState(!1),v=h.useRef(null),k=h.useCallback(()=>{if(!r||v.current)return;const d=t(o,a);d&&(v.current=d,m(d),d.join().receive("ok",()=>{var E;console.log(`Joined channel: ${o}`),P(!0),(E=s.onJoin)==null||E.call(s)}).receive("error",E=>{var x;console.error(`Failed to join channel: ${o}`,E),(x=s.onError)==null||x.call(s,E)}),d.onClose(()=>{var E;console.log(`Channel closed: ${o}`),P(!1),(E=s.onClose)==null||E.call(s)}))},[r,o,JSON.stringify(a)]),u=h.useCallback(()=>{v.current&&(v.current.leave(),v.current=null,m(null),P(!1))},[]),f=h.useCallback((d,E={})=>!v.current||!i?(console.warn(`Cannot push to channel ${o}: not joined`),null):v.current.push(d,E),[i,o]),T=h.useCallback((d,E)=>{if(!v.current)return console.warn(`Cannot listen to channel ${o}: not created`),()=>{};const x=v.current.on(d,E);return()=>{var C;return(C=v.current)==null?void 0:C.off(d,x)}},[o]);return h.useEffect(()=>(r&&k(),()=>{u()}),[r,k]),{channel:c,joined:i,join:k,leave:u,push:f,on:T}},fe=(o={})=>{const{roles:a=[],permissions:s=[],rolePermissions:t={}}=o,r=h.useMemo(()=>{const u=new Set(s);return a.forEach(f=>{(t[f]||[]).forEach(d=>u.add(d))}),Array.from(u)},[a,s,t]),c=u=>r.includes(u),m=u=>u.some(f=>c(f)),i=u=>u.every(f=>c(f)),P=u=>a.includes(u);return{permissions:r,roles:a,hasPermission:c,hasAnyPermission:m,hasAllPermissions:i,hasRole:P,hasAnyRole:u=>u.some(f=>P(f)),hasAllRoles:u=>u.every(f=>P(f))}},$=(o,a,s)=>o.filter(t=>t.requireAuth&&a.length===0||t.permissions&&t.permissions.length>0&&!t.permissions.some(c=>a.includes(c))||t.roles&&t.roles.length>0&&!t.roles.some(c=>s.includes(c))?!1:t.children?$(t.children,a,s).length>0:!0).map(t=>t.children?{...t,children:$(t.children,a,s)}:t),de=(o,a={})=>({path:o,requireAuth:!0,...a});exports.AuthGuard=le;exports.PermissionGuard=ue;exports.PhoenixProvider=ce;exports.createProtectedRoute=de;exports.filterRoutesByPermissions=$;exports.useChannel=ie;exports.usePermissions=fe;exports.usePhoenix=B;
